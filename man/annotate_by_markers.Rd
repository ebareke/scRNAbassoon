% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modules.R
\name{annotate_by_markers}
\alias{annotate_by_markers}
\title{Annotate Cells by Marker Genes}
\usage{
annotate_by_markers(seu, marker_list)
}
\arguments{
\item{seu}{Preprocessed Seurat object from \code{\link{preprocess_data}}}

\item{marker_list}{Named list where names are cell types and values are
character vectors of marker gene symbols}
}
\value{
Seurat object with new metadata columns:
\describe{
\item{cell_type_marker}{Per-cell annotation based on marker expression}
\item{all_cell_types}{Final cell type labels (consensus per cluster)}
}
}
\description{
Assigns cell type labels based on marker gene expression patterns using
a simple scoring approach.
}
\details{
Annotation algorithm:
\enumerate{
\item For each cell, count how many markers are detected (count > 0) for each cell type
\item Assign cell to type with highest marker count
\item If no markers detected, label as "Unknown"
\item If multiple types tie, label as "Ambiguous"
\item Refine by cluster: assign each cluster the most common cell type within it
}

The final \code{all_cell_types} column is used as the primary cell type identity
throughout downstream analysis.
}
\examples{
\dontrun{
# Using built-in markers
seu <- annotate_by_markers(seu, default_mouse_markers)

# Using custom markers
my_markers <- list(
  "T_cells" = c("Cd3d", "Cd3e"),
  "B_cells" = c("Cd79a", "Ms4a1"),
  "Macrophages" = c("Cd68", "Itgam")
)
seu <- annotate_by_markers(seu, my_markers)

# Check results
table(seu$all_cell_types)
}

}
