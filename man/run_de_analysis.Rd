% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modules.R
\name{run_de_analysis}
\alias{run_de_analysis}
\title{Run Differential Expression Analysis}
\usage{
run_de_analysis(
  seu,
  dirs,
  conditions_str,
  format,
  use_offline_gmt,
  gmt_dir,
  gmt_globs
)
}
\arguments{
\item{seu}{Annotated Seurat object}

\item{dirs}{Named list of output directories}

\item{conditions_str}{Character. Comma-separated comparisons (e.g., "GroupA_vs_GroupB,GroupC_vs_GroupD")}

\item{format}{Character. "pdf", "png", or "both"}

\item{use_offline_gmt}{Logical. Use local GMT files for enrichment}

\item{gmt_dir}{Character. Directory containing GMT files}

\item{gmt_globs}{Character. Comma-separated GMT filenames}
}
\value{
NULL (invisible). Saves results to:
\itemize{
\item \code{dirs$de}: DE results and volcano plots per cell type
\item \code{dirs$enrichment}: ORA and GSEA results per cell type
}
}
\description{
Performs pairwise differential expression testing between experimental groups
for each cell type, followed by pathway enrichment analysis.
}
\details{
For each comparison and cell type:
\enumerate{
\item Subset to cells from comparison groups
\item Require â‰¥10 cells per group for testing
\item Perform Wilcoxon rank-sum test (logfc.threshold = 0)
\item Generate volcano plots
\item Run GO enrichment (BP, MF)
\item Run GMT enrichment (if enabled)
\item Perform GSEA on ranked genes
}

Output structure per comparison:
\preformatted{
DE/GroupA_vs_GroupB/
  CellType1/
    DE_results.csv
    Volcano_Plot.pdf
  CellType2/
    ...

Enrichment/GroupA_vs_GroupB/
  CellType1/
    ORA/
      CellType1_GroupA_vs_GroupB_UP_GO_BP.csv
      CellType1_GroupA_vs_GroupB_DOWN_GO_BP.csv
      ...
    GSEA/
      CellType1_GroupA_vs_GroupB_GSEA_GO_BP.csv
      ...
}
}
\section{GMT Files}{

Download GMT files from MSigDB (\url{https://www.gsea-msigdb.org/gsea/msigdb/}):
\itemize{
\item m2.cp.wikipathways: WikiPathways
\item m2.cp.kegg: KEGG pathways
\item m5.go.bp: GO Biological Process
\item h.all: Hallmark gene sets
}
}

\examples{
\dontrun{
# Single comparison without GMT enrichment
run_de_analysis(seu, dirs, "Treatment_vs_Control", "pdf", FALSE, "", "")

# Multiple comparisons with GMT enrichment
run_de_analysis(
  seu, dirs,
  conditions_str = "Mutant_vs_WT,Rescue_vs_Mutant",
  format = "both",
  use_offline_gmt = TRUE,
  gmt_dir = "/reference/msigdb/mouse/",
  gmt_globs = "m2.cp.wikipathways.v2024.1.Mm.symbols.gmt,m2.cp.kegg.v2024.1.Mm.symbols.gmt"
)
}

}
