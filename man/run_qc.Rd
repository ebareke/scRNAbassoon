% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modules.R
\name{run_qc}
\alias{run_qc}
\title{Run Quality Control and Filtering}
\usage{
run_qc(
  seu,
  dirs,
  min_features,
  max_features,
  max_mito_pct,
  plot_format,
  width,
  height
)
}
\arguments{
\item{seu}{Seurat object from \code{\link{load_sc_data}}}

\item{dirs}{Named list of output directories from \code{\link{setup_output_dirs}}}

\item{min_features}{Integer. Minimum features per cell threshold}

\item{max_features}{Integer. Maximum features per cell threshold}

\item{max_mito_pct}{Numeric. Maximum mitochondrial percentage threshold}

\item{plot_format}{Character. "pdf", "png", or "both"}

\item{width}{Numeric. Plot width in inches}

\item{height}{Numeric. Plot height in inches}
}
\value{
Filtered Seurat object with QC metrics in metadata
}
\description{
Performs QC metric calculation, generates diagnostic plots, and filters cells
based on feature count and mitochondrial percentage thresholds.
}
\details{
Calculates and plots:
\itemize{
\item nFeature_RNA: Number of genes detected per cell
\item nCount_RNA: Total UMI counts per cell
\item percent.mt: Percentage of reads mapping to mitochondrial genes
}

Mitochondrial genes are identified by pattern "^mt-" (mouse) or "^MT-" (human).

QC plots saved to \code{dirs$qc}:
\itemize{
\item QC_Metrics_Violin.pdf: Violin plots of QC metrics by group
\item QC_Count_vs_Feature.pdf: Scatter plot of sequencing depth vs complexity
}
}
\examples{
\dontrun{
dirs <- setup_output_dirs("/results/")
seu <- load_sc_data("/data/cellranger/")
seu <- run_qc(seu, dirs, 
              min_features = 200, 
              max_features = 6000, 
              max_mito_pct = 15,
              plot_format = "pdf", 
              width = 14, 
              height = 12)
}

}
